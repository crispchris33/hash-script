{% extends 'base.html' %}

{% block content %}
    <!--Set page title-->
    <script>
        const file_name = "{{ file_name }}";
        document.title = file_name;
    </script>
  
    <div class="container">
      <h1 id="page-title">File: {{ file_name }}</h1>

      <h2>SHA256</h2>
      <table id="table_sha256" class="table table-striped table-hover">
          <thead>
            <tr>
              <th scope="col">SHA256</th>
              <th scope="col">Path</th>
              <th scope="col">File Size</th>
              <th scope="col">Date Time</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
      </table>

      <h2>SHA1</h2>
      <table id="table_sha1" class="table table-striped table-hover">
          <thead>
            <tr>
              <th scope="col">SHA1</th>
              <th scope="col">Path</th>
              <th scope="col">File Size</th>
              <th scope="col">Date Time</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
      </table>

      <h2>MD5</h2>
      <table id="table_md5" class="table table-striped table-hover">
          <thead>
            <tr>
              <th scope="col">MD5</th>
              <th scope="col">Path</th>
              <th scope="col">File Size</th>
              <th scope="col">Date Time</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
      </table>

      <h2>TLSH</h2>
      <table id="table_tlsh" class="table table-striped table-hover">
          <thead>
            <tr>
              <th scope="col">TLSH</th>
              <th scope="col">Path</th>
              <th scope="col">File Size</th>
              <th scope="col">Date Time</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
      </table>

    </div>

    <script>
        $(document).ready(function() {
        const commonConfig = {
            "processing": true,
            "serverSide": true,
            "scrollX": true,
            "columnDefs": [
                { "width": "400px", "targets": 0 },
                { "width": "400px", "targets": 1 },
                { "width": "200px", "targets": 2 },
                { "width": "300px", "targets": 3 },
            ],
            "autoWidth": false
        };
        
            $('#table_sha256').DataTable({
                ...commonConfig,
                "ajax": {
                    "url": "/data_sha256",
                    "type": "POST",
                    "data": {
                        "file": encodeURIComponent(file_name)
                    },
                    "dataSrc": function (json) {
                        return json.data;
                    },
                },
                "columns": [
                    { "data": "sha256" },
                    { "data": "path" },
                    { "data": "file_size" },
                    { "data": "date_time" }
                ]
            });

            $('#table_sha1').DataTable({
                ...commonConfig,
                "ajax": {
                    "url": "/data_sha1",
                    "type": "POST",
                    "data": {
                        "file": file_name
                    }
                },
                "columns": [
                    { "data": "sha1" },
                    { "data": "path" },
                    { "data": "file_size" },
                    { "data": "date_time" }
                ]
            });

            $('#table_md5').DataTable({
                ...commonConfig,
                "ajax": {
                    "url": "/data_md5",
                    "type": "POST",
                    "data": {
                        "file": file_name
                    }
                },
                "columns": [
                    { "data": "md5" },
                    { "data": "path" },
                    { "data": "file_size" },
                    { "data": "date_time" }
                ]
            });

            $('#table_tlsh').DataTable({
                ...commonConfig,
                "ajax": {
                    "url": "/data_tlsh",
                    "type": "POST",
                    "data": {
                        "file": file_name
                    }
                },
                "columns": [
                    { "data": "tlsh" },
                    { "data": "path" },
                    { "data": "file_size" },
                    { "data": "date_time" }
                ]
            });
        });
    </script>
     <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
{% endblock %}
